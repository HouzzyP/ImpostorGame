<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Impostor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <div class="app">
        <header>
            <div class="logo">El Impostor</div>
            <button class="theme-btn" onclick="toggleTheme()" title="Cambiar tema">
                <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <svg class="icon-moon" style="display:none" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
        </header>

        <main>
            <div class="container">

                <!-- HOME SCREEN -->
                <div id="homeScreen" class="screen active">
                    <h1>El Impostor</h1>
                    <p class="subtitle">Encuentra al impostor entre tus amigos</p>
                    <div class="input-group">
                        <label>Tu nombre</label>
                        <input type="text" id="playerNameInput" placeholder="Ingresa tu nombre" maxlength="15"
                            autocomplete="off">
                    </div>
                    <button class="btn btn-primary" onclick="createRoom()">Crear sala</button>
                    <div class="btn-row">
                        <button class="btn btn-secondary" onclick="showJoinScreen()">Unirse a sala</button>
                    </div>
                </div>

                <!-- JOIN SCREEN -->
                <div id="joinScreen" class="screen">
                    <h1>Unirse</h1>
                    <p class="subtitle">Ingresa el codigo de la sala</p>
                    <div class="input-group">
                        <label>Tu nombre</label>
                        <input type="text" id="joinNameInput" placeholder="Ingresa tu nombre" maxlength="15"
                            autocomplete="off">
                    </div>
                    <div class="input-group">
                        <label>Codigo de sala</label>
                        <input type="text" id="roomCodeInput" placeholder="ABC123" maxlength="6" autocomplete="off"
                            style="text-transform:uppercase">
                    </div>
                    <button class="btn btn-primary" onclick="joinRoom()">Unirse</button>
                    <div class="btn-row">
                        <button class="btn btn-ghost" onclick="showHomeScreen()">Volver</button>
                    </div>
                </div>

                <!-- LOBBY - HOST SCREEN -->
                <div id="lobbyHostScreen" class="screen">
                    <div class="room-code-box" onclick="copyRoomCode()">
                        <div class="room-code-label">Codigo de sala</div>
                        <div class="room-code" id="roomCodeDisplay"></div>
                        <div class="room-code-hint">Toca para copiar</div>
                    </div>
                    <div class="card">
                        <div class="card-head">
                            <h3>Jugadores</h3>
                            <span class="count"><span id="playerCount">1</span>/12</span>
                        </div>
                        <div class="player-list" id="playerListHost"></div>
                    </div>
                    <div class="card">
                        <h3>Configuracion</h3>
                        <div class="config-row">
                            <div class="input-group" style="margin-bottom:0">
                                <label>Categoria</label>
                                <select id="categorySelect" onchange="updateConfig()"></select>
                            </div>
                            <div class="input-group" style="margin-bottom:0">
                                <label>Impostores</label>
                                <select id="impostorCountSelect" onchange="updateConfig()">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn random-btn" onclick="randomCategory()">Categoria aleatoria</button>
                    </div>
                    <button class="btn btn-primary" id="startButton" onclick="startGame()" disabled>Iniciar
                        partida</button>
                    <p class="hint">Minimo 4 jugadores</p>
                </div>

                <!-- LOBBY - PLAYER SCREEN -->
                <div id="lobbyPlayerScreen" class="screen">
                    <div class="room-code-box" onclick="copyRoomCode()">
                        <div class="room-code-label">Codigo de sala</div>
                        <div class="room-code" id="roomCodePlayer"></div>
                        <div class="room-code-hint">Toca para copiar</div>
                    </div>
                    <div class="card">
                        <div class="card-head">
                            <h3>Jugadores</h3>
                            <span class="count"><span id="playerCountPlayer">1</span>/12</span>
                        </div>
                        <div class="player-list" id="playerListPlayer"></div>
                    </div>
                    <div class="card">
                        <p class="waiting">Esperando al host...</p>
                    </div>
                </div>

                <!-- ROLE REVEAL SCREEN -->
                <div id="roleScreen" class="screen">
                    <div id="roleCard" class="role-card innocent">
                        <div class="role-label">Tu rol</div>
                        <div class="role-title" id="roleTitle">Inocente</div>
                        <div class="word-display" id="wordDisplay"></div>
                        <p class="role-hint" id="roleHint"></p>
                        <p class="category-tag" id="categoryTag"></p>
                    </div>
                    <button class="btn btn-primary" id="readyButton" onclick="startVoting()"
                        style="display:none">Iniciar votacion</button>
                    <p id="waitingMessage" class="waiting">Esperando al host...</p>
                </div>

                <!-- VOTING SCREEN -->
                <div id="votingScreen" class="screen">
                    <h2>Votacion</h2>
                    <p class="subtitle">Elige a quien eliminar</p>
                    <div class="voting-status" id="votingStatus">
                        <div class="voting-label">Turno de votar</div>
                        <div class="voting-text" id="currentVoterDisplay"></div>
                    </div>
                    <div class="card">
                        <h3>Votos</h3>
                        <div class="votes-log" id="votesDisplay"></div>
                    </div>
                    <div id="votingButtons"></div>
                </div>

                <!-- ELIMINATION SCREEN -->
                <div id="eliminationScreen" class="screen">
                    <div class="result-banner eliminated">
                        <h2 id="eliminatedName"></h2>
                        <p class="result-sub" id="eliminatedRole"></p>
                    </div>
                    <button class="btn btn-primary" onclick="continueGame()">Continuar</button>
                </div>

                <!-- GAME SCREEN -->
                <div id="gameScreen" class="screen">
                    <div id="roleCardGame" class="role-card innocent">
                        <div class="role-label">Tu rol</div>
                        <div class="role-title" id="roleTitleGame">Inocente</div>
                        <div class="word-display" id="wordDisplayGame"></div>
                        <p class="role-hint" id="roleHintGame"></p>
                    </div>
                    <div class="round-badge">Ronda <strong id="roundNumber">1</strong></div>
                    <div class="card">
                        <h3>Jugadores vivos</h3>
                        <div class="player-list" id="alivePlayersList"></div>
                    </div>
                    <button class="btn btn-primary" id="startVotingBtn" onclick="startVoting()"
                        style="display:none">Iniciar votacion</button>
                    <p id="waitingVoteMessage" class="waiting">Esperando al host...</p>
                </div>

                <!-- END SCREEN -->
                <div id="endScreen" class="screen">
                    <div class="result-banner" id="winnerBanner">
                        <h2 id="winnerTitle"></h2>
                        <p class="result-sub" id="winnerMessage"></p>
                    </div>
                    <div class="word-reveal">
                        <div class="word-reveal-label">La palabra era</div>
                        <div class="word-reveal-word" id="revealedWord"></div>
                    </div>
                    <div class="card">
                        <h3>Roles revelados</h3>
                        <div id="finalPlayerList"></div>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="continueInRoom()" id="continueButton"
                            style="display:none">Continuar en la sala</button>
                        <button class="btn btn-secondary" onclick="resetGame()" id="resetButton"
                            style="display:none">Volver al lobby</button>
                        <button class="btn btn-secondary" onclick="location.reload()">Salir</button>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <div id="toastContainer"></div>

    <script src="script.js"></script>
</body>

</html>